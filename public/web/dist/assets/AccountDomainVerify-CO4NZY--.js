import{d as C,r as b,o as r,c as i,a as e,n as D,b as n,u as $,e as g,t as d,w as B,v as N,f as M,I as S,g as E,h as V,i as I,j,_ as F,k as R,l as z,m as T,p as H,q as L}from"./main-C3z6sMGR.js";import{_ as U}from"./DomainVerificationInfo.vue_vue_type_script_setup_true_lang-hA7AedZu.js";const X={class:"px-4 py-5 sm:p-4"},q=C({__name:"MoreInfoText",props:{textColor:{default:"text-brandcomp-800 dark:text-gray-100"},bgColor:{default:"bg-white dark:bg-gray-800"}},setup(f){const t=b(!1),o=l=>{l.preventDefault(),t.value=!t.value},s=f;return(l,_)=>(r(),i("div",{class:D(`mb-4 ${s.bgColor} shadow sm:rounded-lg relative`)},[e("div",X,[e("button",{onClick:o,class:D(`flex items-center text-base font-medium ${s.textColor} hover:text-brandcomp-600 dark:hover:text-brandcomp-400 focus:outline-none`)},[n($(S),{icon:t.value?"heroicons:chevron-down":"heroicons:chevron-right",class:"h-5 w-5 mr-2"},null,8,["icon"]),g(" "+d(t.value?"Hide details":"Expand for more info"),1)],2),B(e("div",{class:D(["absolute left-4 right-4 mt-2 bg-gray-50 dark:bg-gray-700 shadow-lg rounded-lg overflow-hidden transition-all duration-300 ease-in-out z-10 border border-gray-200 dark:border-gray-600",{"max-h-0":!t.value,"max-h-[500px]":t.value}])},[M(l.$slots,"default")],2),[[N,t.value]])])],2))}}),P={class:"relative inline-block"},W=["aria-label"],G={key:0,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},J=e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"},null,-1),K=[J],O={key:1,class:"w-5 h-5 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},Q=e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1),Y=[Q],Z={key:0,class:"absolute z-10 px-2 py-1 text-sm text-white bg-gray-900 rounded-md bottom-full left-1/2 transform -translate-x-1/2 -translate-y-2"},ee=C({__name:"CopyButton",props:{text:{default:""},interval:{default:2e3}},setup(f){const t=f,o=b(!1),s=b(!1),l=()=>{navigator.clipboard.writeText(t.text).then(()=>{o.value=!0,s.value=!0,setTimeout(()=>{o.value=!1,s.value=!1},t.interval)})};return E(()=>{}),(_,m)=>(r(),i("div",P,[e("button",{onClick:l,onMouseenter:m[0]||(m[0]=p=>s.value=!0),onMouseleave:m[1]||(m[1]=p=>s.value=!1),class:"text-gray-600 hover:text-gray-900 dark:text-gray-400 dark:hover:text-white focus:outline-none","aria-label":o.value?"Copied":"Copy to clipboard"},[o.value?(r(),i("svg",O,Y)):(r(),i("svg",G,K))],40,W),s.value?(r(),i("div",Z,d(o.value?"Copied!":"Copy to clipboard"),1)):V("",!0)]))}}),te={class:"flex bg-white dark:bg-gray-600 rounded-md"},ae={class:"w-16 flex-shrink-0 flex items-center justify-end px-3 py-2 bg-gray-100 dark:bg-gray-700 border-r border-gray-200 dark:border-gray-500",ref:"labelContainerRef"},oe={class:"flex-grow flex items-center p-3"},se={class:"flex-grow min-w-0 mr-2"},re={class:"text-gray-800 dark:text-gray-200 block truncate"},ne={key:0,class:"text-gray-400"},ie={class:"flex-shrink-0"},k=C({__name:"DetailField",props:{label:{},value:{},appendix:{}},setup(f){return(t,o)=>(r(),i("div",te,[e("div",ae,[e("span",{class:"text-sm font-medium text-gray-500 dark:text-gray-300",ref:"labelRef"},d(t.label)+":",513)],512),e("div",oe,[e("div",se,[e("span",re,[g(d(t.value),1),t.appendix?(r(),i("span",ne,d(t.appendix),1)):V("",!0)])]),e("div",ie,[n(ee,{text:t.value},null,8,["text"])])])]))}}),le={class:"max-w-2xl mx-auto p-6 bg-white dark:bg-gray-800 rounded-xl shadow-lg"},de={class:"space-y-6 mb-8"},ce={class:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg"},ue=e("h3",{class:"font-semibold text-lg mb-2 text-gray-800 dark:text-white"},"1. Create a TXT record",-1),me=e("p",{class:"mb-2 text-gray-600 dark:text-gray-300"},"Add this hostname to your DNS configuration:",-1),pe={class:"space-y-2"},he={class:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg"},ge=e("h3",{class:"font-semibold text-lg mb-2 text-gray-800 dark:text-white"},"2. Create the A record",-1),fe={class:"space-y-2"},_e=e("li",{class:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg"},[e("h3",{class:"font-semibold text-lg mb-2 text-gray-800 dark:text-white"},"3. Wait for propagation"),e("p",{class:"text-gray-600 dark:text-gray-300"},"DNS changes can take as little as 60 seconds -- or up to 24 hours -- to take effect.")],-1),ye=["disabled"],ve={class:"mt-5 flex items-start bg-white dark:bg-gray-800 p-4 rounded-md"},be=e("p",{class:"text-sm text-gray-500 dark:text-gray-400"}," It may take a few minutes for your SSL certificate to take effect once you've pointed your DNS A record. ",-1),xe=C({__name:"VerifyDomainDetails",props:{domain:{default:()=>({})},cluster:{default:()=>({})},withVerifyCTA:{type:Boolean,default:!1}},emits:["domainVerify"],setup(f,{emit:t}){const o=f,s=t,{isSubmitting:l,error:_,success:m,submitForm:p}=I({url:`/api/v2/account/domains/${o.domain.display_domain}/verify`,successMessage:"Domain verification initiated successfully.",getFormData:()=>new URLSearchParams({domain:o.domain.display_domain}),onSuccess:a=>{console.log("Verification initiated:",a),s("domainVerify",a)},onError:a=>{console.error("Verification failed:",a)}}),y=b(!1),v=j(()=>l.value||y.value),c=()=>{console.info("Refreshing DNS verification details..."),p().finally(()=>{y.value=!0,setTimeout(()=>{y.value=!1},1e4)})};return(a,x)=>{var h,u,w;return r(),i("div",le,[e("ol",de,[e("li",ce,[ue,me,e("div",pe,[n(k,{label:"Type",value:"TXT"}),n(k,{label:"Host",value:a.domain.txt_validation_host,appendix:`.${a.domain.base_domain}`},null,8,["value","appendix"]),n(k,{label:"Value",value:a.domain.txt_validation_value},null,8,["value"])])]),e("li",he,[ge,e("div",fe,[n(k,{label:"Type",value:"A"}),n(k,{label:"Host",value:(h=a.domain)!=null&&h.trd?a.domain.trd:"@",appendix:`.${(u=a.domain)==null?void 0:u.base_domain}`},null,8,["value","appendix"]),n(k,{label:"Value",value:(w=a.cluster)==null?void 0:w.cluster_ip},null,8,["value"])])]),_e]),n(F,{success:$(m),error:$(_)},null,8,["success","error"]),a.withVerifyCTA?(r(),i("button",{key:0,onClick:c,disabled:v.value,class:"w-full sm:w-auto px-6 py-3 text-lg font-semibold text-white bg-brand-500 disabled:bg-gray-400 disabled:cursor-not-allowed hover:bg-brand-600 rounded-lg transition duration-100 ease-in-out"},d($(l)?"Verifying...":"Verify Domain"),9,ye)):V("",!0),e("div",ve,[n($(S),{icon:"mdi:information-outline",class:"h-5 w-5 text-brandcomp-700 mr-2 mt-0.5 flex-shrink-0","aria-hidden":"true"}),be])])}}}),ke={class:""},we=e("h1",{class:"text-3xl font-bold mb-6 text-gray-900 dark:text-white"},"Verify your domain",-1),$e={key:1,class:"text-lg mb-6 text-gray-600 dark:text-gray-300"},Ce={class:"bg-white dark:bg-gray-800 text-brand-600 dark:text-brand-400"},De={class:"px-6 py-6"},Ve={class:"max-w-xl text-base text-gray-600 dark:text-gray-300"},Ae={class:"font-bold bg-white dark:bg-gray-800 px-2 text-brand-600 dark:text-brand-400"},Te=["title"],Se=["title"],Be=e("div",{class:"mt-4 text-sm"},[e("a",{href:"#",class:"font-medium text-brandcomp-600 hover:text-brandcomp-500 dark:text-brandcomp-400 dark:hover:text-brandcomp-300"})],-1),Ne={key:3,class:"text-gray-600 dark:text-gray-400"},Ie=C({__name:"AccountDomainVerify",setup(f){const t=R(),o=b(null),s=b(null);console.log("VerifyDomain.ts",t.params.domain);const l=async()=>{var y,v;const p=t.params.domain;try{const c=await fetch(`/api/v2/account/domains/${p}`);if(!c.ok)throw new Error("Failed to fetch domain information");const a=await c.json();console.debug("json",a),o.value=a.record,a.details&&(s.value=(y=a.details)==null?void 0:y.cluster);const x=Math.floor(Date.now()/1e3),h=((v=o.value)==null?void 0:v.updated)||x;if(h){const u=x-h;u>=30?(console.debug("It has been at least 30 second since the last monitored time.",u),_.value=!0):(console.debug("It has not been 30 seconds yet since the last monitored time.",u),_.value=!1)}}catch(c){console.error("Error fetching domain:",c)}},_=b(!1),m=async p=>{console.log("Domain verified: refreshing domain info",p),await l()};return z(()=>{console.log("AccountDomainVerify component mounted"),console.log("Domain parameter:",t.params.domain),l()}),(p,y)=>{var v,c,a;return r(),i("div",ke,[n(L),we,(c=(v=o.value)==null?void 0:v.vhost)!=null&&c.last_monitored_unix?(r(),T(U,{key:0,domain:o.value,mode:"table"},null,8,["domain"])):(r(),i("p",$e,[g(" Before we can activate links for "),e("span",Ce,d((a=o.value)==null?void 0:a.display_domain),1),g(", you'll need to complete these steps. ")])),n(q,{textColor:"text-brandcomp-800 dark:text-gray-100",bgColor:"bg-white dark:bg-gray-800"},{default:H(()=>{var x,h,u,w,A;return[e("div",De,[e("div",Ve,[e("p",null,[g(" In order to connect your domain, you'll need to have a DNS A record that points "),e("span",Ae,d((x=o.value)==null?void 0:x.display_domain),1),g(" at "),e("span",{title:((h=s.value)==null?void 0:h.cluster_name)??"",class:"bg-white dark:bg-gray-800 px-2"},d((u=s.value)==null?void 0:u.cluster_ip),9,Te),g(". If you already have an A record for that address, please change it to point at "),e("span",{title:((w=s.value)==null?void 0:w.cluster_name)??"",class:"bg-white dark:bg-gray-800 px-2"},d((A=s.value)==null?void 0:A.cluster_ip),9,Se),g(" and remove any other A, AAAA, or CNAME records for that exact address. ")])]),Be])]}),_:1}),o.value&&s.value?(r(),T(xe,{key:2,domain:o.value,cluster:s.value,withVerifyCTA:_.value,onDomainVerify:m},null,8,["domain","cluster","withVerifyCTA"])):(r(),i("p",Ne,"Loading domain information..."))])}}});export{Ie as default};
